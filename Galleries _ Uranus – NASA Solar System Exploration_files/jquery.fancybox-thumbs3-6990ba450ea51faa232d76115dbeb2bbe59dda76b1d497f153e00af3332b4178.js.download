/*!
 * Thumbnail helper for fancyBox
 * version: 2.0.0 (Tue, 29 Jan 2013)
 * @requires fancyBox v3.0 or later
 *
 * Usage:
 *     $(".fancybox").fancybox({
 *         helpers : {
 *             thumbs: {
 *                 width  : 50,
 *                 height : 50
 *             }
 *         }
 *     });
 *
 */
!function(t){var i=t.fancybox;i.helpers.thumbs={defaults:{width:75,height:50,position:"bottom",source:function(){}},list:null,items:null,count:0,_create:function(i){var e,s,h=this.opts;e="",t.each(i.group,function(t){e+='<li><a data-index="'+t+'" href="javascript:jQuery.fancybox.jumpto('+t+');"></a></li>'}),this.list=s=t("<ul>"+e+"</ul>"),this.items=s.children(),this.count=this.items.length,this.wrap=t('<div id="fancybox-thumbs" class="'+h.position+'"></div>').append(s).wrapInner('<div class="inner" />').wrapInner('<div class="outer" />').appendTo("body"),t('<a class="fancybox-thumb-prev" href="javascript:;"><span></span></a>').click(t.proxy(this.prev,this)).prependTo(this.wrap),t('<a class="fancybox-thumb-next" href="javascript:;"><span></span></a>').click(t.proxy(this.next,this)).appendTo(this.wrap),s.find("a").width(h.width).height(h.height),this.width=this.items.outerWidth(!0),this.height=this.items.outerHeight(!0),s.width(this.width*this.count).height(this.height)},_loadPage:function(){var e,s,h=this,a=function(t){h._setThumb(e,t)};this.list&&(e=this.list.find("a").slice(this.start,this.end+1).not(".ready").first())&&e.length&&(e.addClass("ready"),s=i.group[e.data("index")],href=this._getThumb(s,a),"string"===t.type(href)?a(href):href||this._loadPage())},_getThumb:function(i,e){var s,h;return!(s=this.opts.source(i,e))&&i.element&&(s=t(i.element).find("img").attr("src")),!s&&(h=i.href.match(/(youtube\.com|youtu\.be)\/(watch\?v=|v\/|u\/|embed\/?)?(videoseries\?list=(.*)|[\w-]{11}|\?listType=(.*)&list=(.*)).*/i))&&(s="http://img.youtube.com/vi/"+h[3]+"/mqdefault.jpg"),!s&&(h=i.href.match(/(?:vimeo(?:pro)?.com)\/(?:[^\d]+)?(\d+)(?:.*)/))?(t.getJSON("http://www.vimeo.com/api/v2/video/"+h[1]+".json?callback=?",{format:"json"},function(t){e(t[0].thumbnail_small)}),!0):(!s&&"image"===i.type&&i.href&&(s=i.href),s)},_setThumb:function(i,e){var s=this,h=function(){s._loadPage()};this.list&&t("<img />").load(function(){var e,a,n=this.width,o=this.height,r=i.width(),l=i.height();s.wrap&&n&&o?(a=o/l,(e=n/r)>=1&&a>=1&&(e>a?(n/=a,o=l):(n=r,o/=e)),t(this).css({width:Math.floor(n),height:Math.floor(o),"margin-top":Math.floor(.3*l-.3*o),"margin-left":Math.floor(.5*r-.5*n)}).appendTo(i),h()):h()}).error(h).attr("src",e)},_move:function(e){var s,h,a,n=0,o=400;if(this.wrap){if(s=Math.ceil(this.count/this.itemsMin),e===undefined&&(e=Math.floor(i.current.index/this.itemsMin)+1),t(".fancybox-thumb-prev, .fancybox-thumb-next").hide(),s<2)return t.extend(this,{pages:s,page:1,start:0,end:this.count}),this.list.stop(!0).css({"margin-left":"auto","margin-right":"auto",left:0}),void this._loadPage();e<=1?e=1:t(".fancybox-thumb-prev").show(),e>=s?e=s:t(".fancybox-thumb-next").show(),a=(h=(e-1)*this.itemsMin)+this.itemsMax-1,n=this.width*this.itemsMin*(e-1)*-1,this.left!==n&&(t.extend(this,{pages:s,page:e,start:h,end:a,left:n}),this._loadPage(),this.list.stop(!0).animate({"margin-left":n+"px"},o))}},prev:function(){this._move(this.page-1)},next:function(){this._move(this.page+1)},afterLoad:function(t,i){var e="bottom"===t.position?2:0;i.group.length<2?i.helpers.thumbs=!1:(this.wrap||this._create(i),!1!==t.margin&&(i.margin[e]=Math.max(this.height+40,i.margin[e])))},beforeShow:function(t,i){this.items&&(this.items.removeClass("fancybox-thumb-active"),this.current=this.list.find("a[data-index='"+i.index+"']").parent().addClass("fancybox-thumb-active"))},onUpdate:function(){this.wrap&&(this.wrap.width(i.getViewport().w),this.view=this.list.parent().innerWidth(),this.itemsMin=Math.floor(this.view/this.width),this.itemsMax=Math.ceil(this.view/this.width),this._move())},beforeClose:function(){this.wrap&&this.wrap.stop(!0).remove(),t.extend(this,{pages:0,page:0,start:0,end:0,count:0,items:null,left:null,wrap:null,list:null})}}}(jQuery);